<style>
    div.stars {
        width: 270px;
        display: inline-block;
    }

    input.star {
        display: none;
    }

    label.star {
        float: right;
        padding: 10px;
        font-size: 36px;
        color: #444;
        transition: all .2s;
    }

    input.star:checked~label.star:before {
        content: '\2605';
        color: #FD4;
        transition: all .25s;
    }

    input.star-5:checked~label.star:before {
        color: #FE7;
        text-shadow: 0 0 20px #952;
    }

    input.star-1:checked~label.star:before {
        color: #F62;
    }

    label.star:hover {
        transform: rotate(-15deg) scale(1.3);
    }

    label.star:before {
        content: '\2605';
    }
</style>

<a href="/project/projectDetails?id={{projectId}}">
    <u>
        << Back to project</u>
</a>

<a href="/project/resources?id={{projectId}}" class="float-right">
    <u>See Project Resources >></u>
</a>

<p-toast key="toastMsg" [baseZIndex]="100"></p-toast>

<div class="row mt-md-2">
    <div class="col-6">
        <h5>Incoming Requests</h5>
        <ul class="nav nav-tabs" id="myTab" role="tablist">
            <li class="nav-item">
                <a class="nav-link active" id="iPending-tab" data-toggle="tab" href="#iPending" role="tab" aria-controls="iPending" aria-selected="true">Pending</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" id="iAccepted-tab" data-toggle="tab" href="#iAccepted" role="tab" aria-controls="iAccepted" aria-selected="false">Accepted</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" id="iDeclined-tab" data-toggle="tab" href="#iDeclined" role="tab" aria-controls="iDeclined" aria-selected="false">Declined</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" id="iCancelled-tab" data-toggle="tab" href="#iCancelled" role="tab" aria-controls="iCancelled" aria-selected="false">Cancelled</a>
            </li>
        </ul>
        <div class="tab-content" id="myTabContent">
            <div class="tab-pane fade show active" id="iPending" role="tabpanel" aria-labelledby="iPending-tab">
                <div class="card">
                    <p-dataView #ip [value]="iPending" [paginator]="true" [rows]="9" filterBy="title" layout="list">
                        <ng-template pTemplate="header">
                            <div class="p-d-flex p-flex-column p-flex-md-row p-jc-md-between">
                                <p-dropdown [options]="filterNeedOptions" [(ngModel)]="ipfilterKeyNeed" placeholder="Filter by resource need" (onChange)="ipfilterByNeed($event, [(inPen)])"
                                    styleClass="p-mb-2 p-mb-md-0"></p-dropdown>
                            </div>
                        </ng-template>
                        <ng-template let-ip pTemplate="listItem">
                            <div class="p-col-12">
                                <div class="row p-3">
                                    <div class="col-8">
                                        <div class="product-name">
                                            <a href="/resource/resourceDetails?id={{ip.resourceId}}&type={{ip.resType}}">{{ip.resourceTitle}}</a>
                                        </div>
                                        <div>{{ip.desc}}</div>
                                        Offered by {{ip.requesterName}} at {{formatDate(ip.createdAt)}}
                                        <br> For {{ip.needTitle}}
                                    </div>
                                    <div class="col-4">
                                        <div class="float-right">
                                            <i class="pi pi-tag product-category-icon"></i>
                                            <span class="{{ip.resType}}type rounded-sm text-white">&nbsp;{{ip.resType}}&nbsp;</span>
                                        </div>
                                        <br>
                                        <div class="mt-md-2 float-right">
                                            <button class="btn btn-success" title="Accept" (click)="acceptProjReq(ip.id)">
                                                <i class="pi pi-check"></i>
                                            </button>
                                            <button class="btn btn-danger" title="Decline" (click)="declineProjReq(ip.id)">
                                                <i class="pi pi-times"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </ng-template>
                    </p-dataView>
                </div>
            </div>
            <div class="tab-pane fade" id="iAccepted" role="tabpanel" aria-labelledby="iAccepted-tab">
                <div class="card">
                    <p-dataView #ia [value]="iAccepted" [paginator]="true" [rows]="9" filterBy="title" layout="list">
                        <ng-template pTemplate="header">
                            <div class="p-d-flex p-flex-column p-flex-md-row p-jc-md-between">
                                <p-dropdown [options]="filterNeedOptions" placeholder="Filter by resource need" (onChange)="ipfilterByNeed($event, [(inAcc)])"
                                    styleClass="p-mb-2 p-mb-md-0"></p-dropdown>
                            </div>
                        </ng-template>
                        <ng-template let-ia pTemplate="listItem">
                            <div class="p-col-12">
                                <div class="row p-3">
                                    <div class="col-8">
                                        <div class="product-name">
                                            <a *ngIf="ia.resType != 'money'" href="/resource/resourceDetails?id={{ia.resourceId}}&type={{ia.resType}}">{{ia.resourceTitle}}</a>
                                            <span *ngIf="ia.resType == 'money'">Fund: ${{ia.moneySum}}</span>
                                        </div>
                                        <div>{{ia.desc}}</div>
                                        Offered by {{ia.requesterName}} at {{formatDate(ia.createdAt)}}
                                        <br> For {{ia.needTitle}}
                                        <br> Accepted at {{formatDate(ia.updatedAt)}}
                                    </div>
                                    <div class="col-4">
                                        <div class="float-right">
                                            <i class="pi pi-tag product-category-icon"></i>
                                            <span class="{{ia.resType}}type rounded-sm text-white">&nbsp;{{ia.resType}}&nbsp;</span>
                                        </div>
                                        <br>
                                        <div class="mt-md-2 float-right">
                                            <button class="btn btn-success" title="Complete" data-toggle="modal" data-target="#completeModal" (click)="getForm(ia)">
                                                <i class="pi pi-check"></i>
                                            </button>
                                            <button class="btn btn-danger" title="Cancel" (click)="cancelProjReq(ia.id)">
                                                <i class="pi pi-times"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </ng-template>
                    </p-dataView>
                    <div class="modal fade" id="completeModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                        <div class="modal-dialog" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="exampleModalLabel">Complete and Rate Contribution</h5>
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">&times;</span>
                                    </button>
                                </div>
                                <div class="modal-body">

                                    <form name="form" (ngSubmit)="f.form.valid && completeProjReq()" #f="ngForm" novalidate>
                                        <div class="form-group row">
                                            <label for="title" class="col-sm-5 col-form-label">Resource Need:</label>
                                            <div class="col-sm-7">
                                                <input readonly type="text" class="form-control" name="title" [(ngModel)]="checkForm.needTitle" required #title="ngModel"
                                                />
                                            </div>
                                        </div>
                                        <div class="form-group row">
                                            <label for="desc" class="col-sm-5 col-form-label">Resource Provided:</label>
                                            <div class="col-sm-7">
                                                <input readonly type="text" class="form-control" name="desc" [(ngModel)]="checkForm.resTitle" #desc="ngModel" />
                                            </div>
                                        </div>
                                        <div class="form-group row">
                                            <label for="desc" class="col-sm-5 col-form-label">Resource Owner:</label>
                                            <div class="col-sm-7">
                                                <input readonly type="text" class="form-control" name="owner" [(ngModel)]="checkForm.user" #owner="ngModel" />
                                            </div>
                                        </div>
                                        <div class="form-group row">
                                            <label for="rating" class="col-sm-4 col-form-label">Rating:</label>
                                            <div class="col-sm-7">
                                                <div class="stars">
                                                    <form action="">
                                                        <input class="star star-5" value="5" id="star-5" type="radio" name="star" (change)="clickRating(5, $event)" />
                                                        <label class="star star-5" for="star-5"></label>
                                                        <input class="star star-4" value="4" id="star-4" type="radio" name="star" (change)="clickRating(4, $event)" />
                                                        <label class="star star-4" for="star-4"></label>
                                                        <input class="star star-3" value="3" id="star-3" type="radio" name="star" (change)="clickRating(3, $event)" />
                                                        <label class="star star-3" for="star-3"></label>
                                                        <input class="star star-2" value="2" id="star-2" type="radio" name="star" (change)="clickRating(2, $event)" />
                                                        <label class="star star-2" for="star-2"></label>
                                                        <input class="star star-1" value="1" id="star-1" type="radio" name="star" (change)="clickRating(1, $event)" />
                                                        <label class="star star-1" for="star-1"></label>
                                                    </form>
                                                </div>
                                                <!--select class="form-control" name="rating" [(ngModel)]="cRating" required #rating="ngModel">
                                                    <option value="" selected hidden>Choose...</option>
                                                    <option value="1">1</option>
                                                    <option value="2">2</option>
                                                    <option value="3">3</option>
                                                    <option value="4">4</option>
                                                    <option value="5">5</option>
                                                </select>
                                                <div class="alert-danger" *ngIf="f.submitted && rating.invalid">
                                                    <div *ngIf="rating.errors.required">Rating is required</div>
                                                </div-->
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <button class="btn btn-primary btn-block">Complete</button>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="tab-pane fade" id="iDeclined" role="tabpanel" aria-labelledby="iDeclined-tab">
                <div class="card">
                    <p-dataView #id [value]="iDeclined" [paginator]="true" [rows]="9" filterBy="title" layout="list">
                        <ng-template pTemplate="header">
                            <div class="p-d-flex p-flex-column p-flex-md-row p-jc-md-between">
                                <p-dropdown [options]="filterNeedOptions" placeholder="Filter by resource need" (onChange)="ipfilterByNeed($event, [(inDec)])"
                                    styleClass="p-mb-2 p-mb-md-0"></p-dropdown>
                            </div>
                        </ng-template>
                        <ng-template let-id pTemplate="listItem">
                            <div class="p-col-12">
                                <div class="row p-3">
                                    <div class="col-8">
                                        <div class="product-name">
                                            <a href="/resource/resourceDetails?id={{id.resourceId}}&type={{id.resType}}">{{id.resourceTitle}}</a>
                                        </div>
                                        <div>{{id.desc}}</div>
                                        Offered by {{id.requesterName}} at {{formatDate(id.createdAt)}}
                                        <br> For {{id.needTitle}}
                                        <br> Declined at {{formatDate(id.updatedAt)}}
                                    </div>
                                    <div class="col-4">
                                        <div class="float-right">
                                            <i class="pi pi-tag product-category-icon"></i>
                                            <span class="{{id.resType}}type rounded-sm text-white">&nbsp;{{id.resType}}&nbsp;</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </ng-template>
                    </p-dataView>
                </div>
            </div>
            <div class="tab-pane fade" id="iCancelled" role="tabpanel" aria-labelledby="iCancelled-tab">
                <div class="card">
                    <p-dataView #ic [value]="iCancelled" [paginator]="true" [rows]="9" filterBy="title" layout="list">
                        <ng-template pTemplate="header">
                            <div class="p-d-flex p-flex-column p-flex-md-row p-jc-md-between">
                                <p-dropdown [options]="filterNeedOptions" placeholder="Filter by resource need" (onChange)="ipfilterByNeed($event, [(inCan)])"
                                    styleClass="p-mb-2 p-mb-md-0"></p-dropdown>
                            </div>
                        </ng-template>
                        <ng-template let-ic pTemplate="listItem">
                            <div class="p-col-12">
                                <div class="row p-3">
                                    <div class="col-8">
                                        <div class="product-name">
                                            <a *ngIf="ic.resType != 'money'" href="/resource/resourceDetails?id={{ic.resourceId}}&type={{ic.resType}}">{{ic.resourceTitle}}</a>
                                            <span *ngIf="ic.resType == 'money'">Fund: ${{ic.moneySum}}</span>
                                        </div>
                                        <div>{{ic.desc}}</div>
                                        Offered by {{ic.requesterName}} at {{formatDate(ic.createdAt)}}
                                        <br> For {{ic.needTitle}}
                                        <br> Cancelled at {{formatDate(ic.updatedAt)}}
                                        <span *ngIf="ic.cancelType == 'project'">by this project</span>
                                        <span *ngIf="ic.cancelType == 'contributor'">by {{ic.requesterName}}</span>
                                    </div>
                                    <div class="col-4">
                                        <div class="float-right">
                                            <i class="pi pi-tag product-category-icon"></i>
                                            <span class="{{ic.resType}}type rounded-sm text-white">&nbsp;{{ic.resType}}&nbsp;</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </ng-template>
                    </p-dataView>
                </div>
            </div>
        </div>
    </div>

    <div class="col-6">
        <h5>Outgoing Requests</h5>
        <ul class="nav nav-tabs" id="myTab" role="tablist">
            <li class="nav-item">
                <a class="nav-link active" id="oPending-tab" data-toggle="tab" href="#oPending" role="tab" aria-controls="oPending" aria-selected="true">Pending</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" id="oAccepted-tab" data-toggle="tab" href="#oAccepted" role="tab" aria-controls="oAccepted" aria-selected="false">Accepted</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" id="oDeclined-tab" data-toggle="tab" href="#oDeclined" role="tab" aria-controls="oDeclined" aria-selected="false">Declined</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" id="oCancelled-tab" data-toggle="tab" href="#oCancelled" role="tab" aria-controls="oCancelled" aria-selected="false">Cancelled</a>
            </li>
        </ul>
        <div class="tab-content" id="myTabContent">
            <div class="tab-pane fade show active" id="oPending" role="tabpanel" aria-labelledby="oPending-tab">
                <div class="card">
                    <p-dataView #op [value]="oPending" [paginator]="true" [rows]="9" filterBy="title" layout="list">
                        <ng-template pTemplate="header">
                            <div class="p-d-flex p-flex-column p-flex-md-row p-jc-md-between">
                                <p-dropdown [options]="filterNeedOptions" placeholder="Filter by resource need" (onChange)="ipfilterByNeed($event, [(outPen)])"
                                    styleClass="p-mb-2 p-mb-md-0"></p-dropdown>
                            </div>
                        </ng-template>
                        <ng-template let-op pTemplate="listItem">
                            <div class="p-col-12">
                                <div class="row p-3">
                                    <div class="col-8">
                                        <div class="product-name">
                                            <a href="/resource/resourceDetails?id={{op.resourceId}}&type={{op.resType}}">{{op.resourceTitle}}</a>
                                        </div>
                                        <div>{{op.desc}}</div>
                                        Submitted at {{formatDate(op.createdAt)}}
                                        <br> For {{op.needTitle}}
                                    </div>
                                    <div class="col-4">
                                        <div class="float-right">
                                            <i class="pi pi-tag product-category-icon"></i>
                                            <span class="{{op.resType}}type rounded-sm text-white">&nbsp;{{op.resType}}&nbsp;</span>
                                        </div>
                                        <br>
                                        <div class="mt-md-2 float-right">
                                            <button class="btn btn-danger float-right" title="Cancel" (click)="cancelResReq(op.id)">
                                                <i class="pi pi-times"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </ng-template>
                    </p-dataView>
                </div>
            </div>
            <div class="tab-pane fade" id="oAccepted" role="tabpanel" aria-labelledby="iAccepted-tab">
                <div class="card">
                    <p-dataView #oa [value]="oAccepted" [paginator]="true" [rows]="9" filterBy="title" layout="list">
                        <ng-template pTemplate="header">
                            <div class="p-d-flex p-flex-column p-flex-md-row p-jc-md-between">
                                <p-dropdown [options]="filterNeedOptions" placeholder="Filter by resource need" (onChange)="ipfilterByNeed($event, [(outAcc)])"
                                    styleClass="p-mb-2 p-mb-md-0"></p-dropdown>
                            </div>
                        </ng-template>
                        <ng-template let-oa pTemplate="listItem">
                            <div class="p-col-12">
                                <div class="row p-3">
                                    <div class="col-8">
                                        <div class="product-name">
                                            <a href="/resource/resourceDetails?id={{oa.resourceId}}&type={{oa.resType}}">{{oa.resourceTitle}}</a>
                                        </div>
                                        <div>{{oa.desc}}</div>
                                        Submitted at {{formatDate(oa.createdAt)}}
                                        <br> For {{oa.needTitle}}
                                        <br> Accepted at {{formatDate(oa.updatedAt)}}
                                    </div>
                                    <div class="col-4">
                                        <div class="float-right">
                                            <i class="pi pi-tag product-category-icon"></i>
                                            <span class="{{oa.resType}}type rounded-sm text-white">&nbsp;{{oa.resType}}&nbsp;</span>
                                        </div>
                                        <br>
                                        <div class="mt-md-2 float-right">
                                            <button class="btn btn-success" title="Complete" data-toggle="modal" data-target="#completeResModal" (click)="getFormB(oa)">
                                                <i class="pi pi-check"></i>
                                            </button>
                                            <button class="btn btn-danger float-right" title="Cancel" (click)="cancelResReq(oa.id)">
                                                <i class="pi pi-times"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </ng-template>
                    </p-dataView>
                    <div class="modal fade" id="completeResModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                        <div class="modal-dialog" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="exampleModalLabel">Complete and Rate Contribution</h5>
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">&times;</span>
                                    </button>
                                </div>
                                <div class="modal-body">
                                    <form name="form" (ngSubmit)="f.form.valid && completeResReq()" #f="ngForm" novalidate>
                                        <div class="form-group row">
                                            <label for="title" class="col-sm-5 col-form-label">Resource Need:</label>
                                            <div class="col-sm-7">
                                                <input readonly type="text" class="form-control" name="title" [(ngModel)]="checkForm.needTitle" required #title="ngModel"
                                                />
                                            </div>
                                        </div>
                                        <div class="form-group row">
                                            <label for="desc" class="col-sm-5 col-form-label">Resource Provided:</label>
                                            <div class="col-sm-7">
                                                <input readonly type="text" class="form-control" name="desc" [(ngModel)]="checkForm.resTitle" #desc="ngModel" />
                                            </div>
                                        </div>
                                        <div class="form-group row">
                                            <label for="rating" class="col-sm-4 col-form-label">Rating:</label>
                                            <div class="col-sm-7">
                                                <div class="stars">
                                                    <form action="">
                                                        <input class="star star-5" value="5" id="star-10" type="radio" name="star" (change)="clickRating(5, $event)" />
                                                        <label class="star star-5" for="star-10"></label>
                                                        <input class="star star-4" value="4" id="star-9" type="radio" name="star" (change)="clickRating(4, $event)" />
                                                        <label class="star star-4" for="star-9"></label>
                                                        <input class="star star-3" value="3" id="star-8" type="radio" name="star" (change)="clickRating(3, $event)" />
                                                        <label class="star star-3" for="star-8"></label>
                                                        <input class="star star-2" value="2" id="star-7" type="radio" name="star" (change)="clickRating(2, $event)" />
                                                        <label class="star star-2" for="star-7"></label>
                                                        <input class="star star-1" value="1" id="star-6" type="radio" name="star" (change)="clickRating(1, $event)" />
                                                        <label class="star star-1" for="star-6"></label>
                                                    </form>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <button class="btn btn-primary btn-block">Complete</button>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="tab-pane fade" id="oDeclined" role="tabpanel" aria-labelledby="oDeclined-tab">
                <div class="card">
                    <p-dataView #od [value]="oDeclined" [paginator]="true" [rows]="9" filterBy="title" layout="list">
                        <ng-template pTemplate="header">
                            <div class="p-d-flex p-flex-column p-flex-md-row p-jc-md-between">
                                <p-dropdown [options]="filterNeedOptions" placeholder="Filter by resource need" (onChange)="ipfilterByNeed($event, [(outDec)])"
                                    styleClass="p-mb-2 p-mb-md-0"></p-dropdown>
                            </div>
                        </ng-template>
                        <ng-template let-od pTemplate="listItem">
                            <div class="p-col-12">
                                <div class="row p-3">
                                    <div class="col-8">
                                        <div class="product-name">
                                            <a href="/resource/resourceDetails?id={{od.resourceId}}&type={{od.resType}}">{{od.resourceTitle}}</a>
                                        </div>
                                        <div>{{od.desc}}</div>
                                        Submitted at {{formatDate(od.createdAt)}}
                                        <br> For {{od.needTitle}}
                                        <br> Declined at {{formatDate(od.updatedAt)}}
                                    </div>
                                    <div class="col-4">
                                        <div class="float-right">
                                            <i class="pi pi-tag product-category-icon"></i>
                                            <span class="{{od.resType}}type rounded-sm text-white">&nbsp;{{od.resType}}&nbsp;</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </ng-template>
                    </p-dataView>
                </div>
            </div>
            <div class="tab-pane fade" id="oCancelled" role="tabpanel" aria-labelledby="oCancelled-tab">
                <div class="card">
                    <p-dataView #oc [value]="oCancelled" [paginator]="true" [rows]="9" filterBy="title" layout="list">
                        <ng-template pTemplate="header">
                            <div class="p-d-flex p-flex-column p-flex-md-row p-jc-md-between">
                                <p-dropdown [options]="filterNeedOptions" placeholder="Filter by resource need" (onChange)="ipfilterByNeed($event, [(outCan)])"
                                    styleClass="p-mb-2 p-mb-md-0"></p-dropdown>
                            </div>
                        </ng-template>
                        <ng-template let-oc pTemplate="listItem">
                            <div class="p-col-12">
                                <div class="row p-3">
                                    <div class="col-8">
                                        <div class="product-name">
                                            <a href="/resource/resourceDetails?id={{oc.resourceId}}&type={{oc.resType}}">{{oc.resourceTitle}}</a>
                                        </div>
                                        <div>{{oc.desc}}</div>
                                        Submitted at {{formatDate(oc.createdAt)}}
                                        <br> For {{oc.needTitle}}
                                        <br> Cancelled at {{formatDate(oc.updatedAt)}}
                                        <span *ngIf="oc.cancelType == 'project'">by this project</span>
                                        <span *ngIf="oc.cancelType == 'contributor'">by resource owner</span>
                                    </div>
                                    <div class="col-4">
                                        <div class="float-right">
                                            <i class="pi pi-tag product-category-icon"></i>
                                            <span class="{{oc.resType}}type rounded-sm text-white">&nbsp;{{oc.resType}}&nbsp;</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </ng-template>
                    </p-dataView>
                </div>
            </div>
        </div>
    </div>
</div>